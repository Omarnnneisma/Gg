<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Delta-X Cloud Engine</title>
    <style>
        body { background: #050505; color: #00ff41; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; }
        .container { margin-top: 50px; }
        video { width: 90%; max-width: 600px; border: 3px solid #00ff41; border-radius: 20px; box-shadow: 0 0 30px #00ff41; background: #000; }
        .btn-stream { padding: 15px 40px; background: #00ff41; color: #000; border: none; cursor: pointer; font-weight: bold; border-radius: 50px; font-size: 22px; transition: 0.3s; margin-top: 20px; }
        .btn-stream:hover { box-shadow: 0 0 50px #00ff41; transform: scale(1.05); }
        #status { margin-top: 20px; font-size: 18px; color: #00ff41; opacity: 0.8; }
    </style>
</head>
<body>
    <div class="container">
        <h1>DELTA-X CORE HOST</h1>
        <video id="localVideo" autoplay playsinline muted></video>
        <br>
        <button id="startBtn" class="btn-stream">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø« Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ</button>
        <div id="status">Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù†ØªØ¸Ø§Ø± Core.java...</div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCpeOSPCzow5Iv472BUEmKvYVt63cIsi-E",
            authDomain: "delta-x-b7b69.firebaseapp.com",
            databaseURL: "https://delta-x-b7b69-default-rtdb.firebaseio.com",
            projectId: "delta-x-b7b69",
            storageBucket: "delta-x-b7b69.firebasestorage.app",
            messagingSenderId: "758371825673",
            appId: "1:758371825673:web:59fcf8401f5ae58bf9a0d8"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        document.getElementById('startBtn').onclick = async () => {
            const status = document.getElementById('status');
            try {
                // Ù†Ø¯Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ÙŠ Ø¨ØªØ±Ø¨Ø· Ø¨Ø§Ù„Ù€ Core ÙÙŠ Ø§Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯
                const stream = await navigator.mediaDevices.getDisplayMedia({ video: true });
                document.getElementById('localVideo').srcObject = stream;
                status.innerText = "Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù†Ø´Ø· Ø§Ù„Ø¢Ù† âœ…";

                // Ø¥Ø¹Ø¯Ø§Ø¯ WebRTC
                const pc = new RTCPeerConnection({ iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] });
                stream.getTracks().forEach(track => pc.addTrack(track, stream));

                pc.onicecandidate = e => {
                    if (e.candidate) db.ref('rooms/1/hostCandidates').push(e.candidate.toJSON());
                };

                const offer = await pc.createOffer();
                await pc.setLocalDescription(offer);
                await db.ref('rooms/1').set({ offer: { type: offer.type, sdp: offer.sdp } });

                db.ref('rooms/1/answer').on('value', async (snap) => {
                    if (snap.val() && !pc.currentRemoteDescription) {
                        await pc.setRemoteDescription(new RTCIceDescription(snap.val()));
                        status.innerText = "Ù…ØªØµÙ„ Ø¨Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¢Ø®Ø± ğŸ“¡";
                    }
                });
            } catch (err) {
                status.innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ Core: " + err.message;
            }
        };
    </script>
</body>
</html>
