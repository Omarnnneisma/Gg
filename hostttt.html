<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delta X - Ultra Host</title>
    <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.18.0.js"></script>
    <style>
        :root { --neon: #00ffcc; --bg: #050505; }
        body { background: var(--bg); color: #fff; font-family: 'Courier New', monospace; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .terminal { background: #111; border: 2px solid var(--neon); padding: 25px; border-radius: 15px; width: 90%; max-width: 450px; box-shadow: 0 0 30px rgba(0,255,204,0.3); }
        h1 { color: var(--neon); text-transform: uppercase; letter-spacing: 2px; font-size: 1.5rem; }
        .status-light { display: inline-block; width: 12px; height: 12px; border-radius: 50%; background: #ff4444; margin-left: 10px; }
        .online { background: #00ff00 !important; box-shadow: 0 0 10px #00ff00; }
        button { background: var(--neon); color: #000; border: none; padding: 15px; width: 100%; font-weight: bold; font-size: 1.1rem; cursor: pointer; border-radius: 5px; margin-top: 20px; transition: 0.3s; }
        button:active { transform: scale(0.95); }
        #console { text-align: left; font-size: 0.7rem; color: #888; margin-top: 15px; height: 60px; overflow-y: auto; background: #000; padding: 10px; }
    </style>
</head>
<body>

<div class="terminal">
    <h1>Delta X Engine <span id="light" class="status-light"></span></h1>
    <p style="font-size: 0.9rem;">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø« Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ: <span style="color:var(--neon)">Active</span></p>
    
    <div id="console">Ø¨Ø¥Ù†ØªØ¸Ø§Ø± Ø£ÙˆØ§Ù…Ø± Ø§Ù„ØªØ´ØºÙŠÙ„...</div>

    <button id="mainBtn" onclick="igniteEngine()">Ø¥Ø·Ù„Ø§Ù‚ Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø« ğŸš€</button>
</div>

<script>
    const APP_ID = "0350681b9ec943c38da2482871048c08";
    const CHANNEL = "delta-x-global";
    const client = AgoraRTC.createClient({ mode: "rtc", codec: "vp8" });
    let screenTrack = null;

    function print(msg) {
        const c = document.getElementById('console');
        c.innerHTML += "> " + msg + "<br>";
        c.scrollTop = c.scrollHeight;
    }

    async function igniteEngine() {
        // 1. ÙØ­Øµ Ø§Ù„Ø£Ù…Ø§Ù† (Ø¹Ø´Ø§Ù† Ù†ØªÙØ§Ø¯Ù‰ Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù‚Ø¯ÙŠÙ…)
        if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
            alert("Ø®Ø·Ø£ Ø£Ù…Ù†ÙŠ: ÙŠØ¬Ø¨ Ø±ÙØ¹ Ø§Ù„ÙƒÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¶Ø§ÙØ© HTTPS (Ù…Ø«Ù„ GitHub Pages) Ù„ÙŠØ¹Ù…Ù„ Ø¥Ø°Ù† Ø§Ù„Ø´Ø§Ø´Ø©.");
            return;
        }

        try {
            print("Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø§ØªØµØ§Ù„...");
            await client.join(APP_ID, CHANNEL, null, null);
            print("ØªÙ… Ø§Ù„Ø±Ø¨Ø· Ø¨Ø³ÙŠØ±ÙØ±Ø§Øª Agora Ø¨Ù†Ø¬Ø§Ø­.");

            print("Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ù†Ø¸Ø§Ù… (System Capture)...");
            
            // Ø£Ù‚ÙˆÙ‰ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù„Ø¨Ø« Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ (Game Mode)
            screenTrack = await AgoraRTC.createScreenVideoTrack({
                encoderConfig: {
                    width: 854, height: 480, // Ø¯Ù‚Ø© Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
                    frameRate: 60,           // Ø£Ù‚ØµÙ‰ Ø³Ù„Ø§Ø³Ø© Ù…Ù…ÙƒÙ†Ø© Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨
                    bitrateMax: 1200,        // ØªÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„Ø³Ø±Ø¹Ø©
                    optimizationMode: "detail"
                }
            }, "auto");

            await client.publish(screenTrack);
            
            document.getElementById('light').classList.add('online');
            document.getElementById('mainBtn').style.display = 'none';
            print("Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§ÙƒØªÙ…Ù„Øª. Delta X Ø§Ù„Ø¢Ù† Ù…Ø¨Ø§Ø´Ø± Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹!");
            
            // Ù…Ù†Ø¹ Ø§Ù„ØµÙØ­Ø© Ù…Ù† Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
            screenTrack.on("track-ended", () => {
                location.reload();
            });

        } catch (err) {
            print("ÙØ´Ù„ Ø§Ù„Ù…Ø­Ø±Ùƒ: " + err.name);
            if(err.name === "NotSupportedError") {
                alert("Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ±ÙØ¶ getUserMedia. ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Desktop Site ÙˆØ£Ù†Ù‡ Ø±Ø§Ø¨Ø· HTTPS.");
            }
        }
    }
</script>
</body>
</html>
